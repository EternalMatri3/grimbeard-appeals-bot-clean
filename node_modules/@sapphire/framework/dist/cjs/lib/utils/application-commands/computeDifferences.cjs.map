{"version":3,"sources":["../../../../../src/lib/utils/application-commands/computeDifferences.ts"],"names":["ApplicationCommandType","contextMenuTypes","casted","checkName","checkDMPermission","checkDefaultMemberPermissions","originalLocalizedNames","expectedLocalizedNames","checkLocalizations","checkIntegrationTypes","checkInteractionContextTypes","checkDescription","checkOptions"],"mappings":"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","file":"computeDifferences.cjs","sourcesContent":["import {\n\tApplicationCommandType,\n\ttype RESTPostAPIApplicationCommandsJSONBody,\n\ttype RESTPostAPIChatInputApplicationCommandsJSONBody,\n\ttype RESTPostAPIContextMenuApplicationCommandsJSONBody\n} from 'discord-api-types/v10';\nimport type { InternalAPICall } from './ApplicationCommandRegistry';\nimport { contextMenuTypes, type CommandDifference } from './compute-differences/_shared';\nimport { checkDefaultMemberPermissions } from './compute-differences/default_member_permissions';\nimport { checkDescription } from './compute-differences/description';\nimport { checkDMPermission } from './compute-differences/dm_permission';\nimport { checkLocalizations } from './compute-differences/localizations';\nimport { checkName } from './compute-differences/name';\nimport { checkOptions } from './compute-differences/options';\nimport { checkIntegrationTypes } from './compute-differences/integration_types';\nimport { checkInteractionContextTypes } from './compute-differences/contexts';\n\n/**\n * @returns `true` if there are differences, `false` otherwise\n */\nexport function getCommandDifferencesFast(\n\texistingCommand: RESTPostAPIApplicationCommandsJSONBody,\n\tapiData: InternalAPICall['builtData'],\n\tguildCommand: boolean\n) {\n\tfor (const _ of getCommandDifferences(existingCommand, apiData, guildCommand)) {\n\t\t// Return immediately on first difference found (also means we skip all other checks)\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n\nexport function* getCommandDifferences(\n\texistingCommand: RESTPostAPIApplicationCommandsJSONBody,\n\tapiData: InternalAPICall['builtData'],\n\tguildCommand: boolean\n): Generator<CommandDifference> {\n\tif (existingCommand.type !== ApplicationCommandType.ChatInput && existingCommand.type) {\n\t\t// Check context menus\n\t\tif (contextMenuTypes.includes(existingCommand.type ?? ApplicationCommandType.ChatInput)) {\n\t\t\tconst casted = apiData as RESTPostAPIContextMenuApplicationCommandsJSONBody;\n\n\t\t\t// Check name\n\t\t\tyield* checkName({ oldName: existingCommand.name, newName: casted.name });\n\n\t\t\t// Check dmPermission only for non-guild commands\n\t\t\tif (!guildCommand) {\n\t\t\t\tyield* checkDMPermission(existingCommand.dm_permission, casted.dm_permission);\n\t\t\t}\n\n\t\t\t// Check defaultMemberPermissions\n\t\t\tyield* checkDefaultMemberPermissions(existingCommand.default_member_permissions, casted.default_member_permissions);\n\n\t\t\t// Check localized names\n\t\t\tconst originalLocalizedNames = existingCommand.name_localizations;\n\t\t\tconst expectedLocalizedNames = casted.name_localizations;\n\n\t\t\tyield* checkLocalizations({\n\t\t\t\tlocaleMapName: 'nameLocalizations',\n\t\t\t\tlocalePresentMessage: 'localized names',\n\t\t\t\tlocaleMissingMessage: 'no localized names',\n\t\t\t\toriginalLocalizedDescriptions: originalLocalizedNames,\n\t\t\t\texpectedLocalizedDescriptions: expectedLocalizedNames\n\t\t\t});\n\n\t\t\t// Check integration types\n\t\t\tyield* checkIntegrationTypes(existingCommand.integration_types, casted.integration_types);\n\n\t\t\t// Check contexts\n\t\t\tyield* checkInteractionContextTypes(existingCommand.contexts, casted.contexts);\n\t\t}\n\n\t\treturn;\n\t}\n\n\tconst casted = apiData as RESTPostAPIChatInputApplicationCommandsJSONBody;\n\n\t// Check name\n\tyield* checkName({ oldName: existingCommand.name.toLowerCase(), newName: casted.name.toLowerCase() });\n\n\t// Check localized names\n\tconst originalLocalizedNames = existingCommand.name_localizations;\n\tconst expectedLocalizedNames = casted.name_localizations;\n\n\tyield* checkLocalizations({\n\t\tlocaleMapName: 'nameLocalizations',\n\t\tlocalePresentMessage: 'localized names',\n\t\tlocaleMissingMessage: 'no localized names',\n\t\toriginalLocalizedDescriptions: originalLocalizedNames,\n\t\texpectedLocalizedDescriptions: expectedLocalizedNames\n\t});\n\n\t// Check dmPermission\n\tif (!guildCommand) {\n\t\tyield* checkDMPermission(existingCommand.dm_permission, casted.dm_permission);\n\t}\n\n\t// Check defaultMemberPermissions\n\tyield* checkDefaultMemberPermissions(existingCommand.default_member_permissions, casted.default_member_permissions);\n\n\t// Check description\n\tyield* checkDescription({ oldDescription: existingCommand.description, newDescription: casted.description });\n\n\t// Check localized descriptions\n\tconst originalLocalizedDescriptions = existingCommand.description_localizations;\n\tconst expectedLocalizedDescriptions = casted.description_localizations;\n\n\tyield* checkLocalizations({\n\t\tlocaleMapName: 'descriptionLocalizations',\n\t\tlocalePresentMessage: 'localized descriptions',\n\t\tlocaleMissingMessage: 'no localized descriptions',\n\t\toriginalLocalizedDescriptions,\n\t\texpectedLocalizedDescriptions\n\t});\n\n\t// Check integration types\n\tyield* checkIntegrationTypes(existingCommand.integration_types, casted.integration_types);\n\n\t// Check contexts\n\tyield* checkInteractionContextTypes(existingCommand.contexts, casted.contexts);\n\n\tyield* checkOptions(existingCommand.options, casted.options);\n}\n"]}