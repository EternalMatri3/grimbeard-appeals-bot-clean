{"version":3,"sources":["../../../src/preconditions/RunIn.ts"],"names":["AllFlowsPrecondition","Command","Identifiers","container"],"mappings":";;;;;;;;;AAWO,IAAM,iBAAA,GAAN,MAAM,iBAAA,SAAyBA,qCAAA,CAAqB;AAAA,EAC1C,UAAA,CAAW,OAAA,EAA2B,CAAA,EAAmB,OAAA,EAAgE;AACxI,IAAA,MAAM,WAAA,GAAc,SAAA;AACpB,IAAA,IAAI,CAAC,OAAA,CAAQ,KAAA,EAAO,OAAO,KAAK,EAAA,EAAG;AAEnC,IAAA,MAAM,WAAA,GAAc,QAAQ,OAAA,CAAQ,IAAA;AAEpC,IAAA,IAAIC,mBAAA,CAAQ,0BAAA,CAA2B,OAAA,CAAQ,KAAK,CAAA,EAAG;AACtD,MAAA,OAAO,OAAA,CAAQ,KAAA,CAAM,UAAA,CAAW,QAAA,CAAS,WAAW,CAAA,GAAI,IAAA,CAAK,EAAA,EAAG,GAAI,IAAA,CAAK,eAAA,CAAgB,OAAA,EAAS,WAAW,CAAA;AAAA,IAC9G;AAEA,IAAA,OAAO,OAAA,CAAQ,KAAA,CAAM,QAAA,CAAS,WAAW,CAAA,GAAI,IAAA,CAAK,EAAA,EAAG,GAAI,IAAA,CAAK,eAAA,CAAgB,OAAA,EAAS,WAAW,CAAA;AAAA,EACnG;AAAA,EAEA,MAAsB,YAAA,CACrB,WAAA,EACA,CAAA,EACA,OAAA,EACmC;AACnC,IAAA,MAAM,WAAA,GAAc,YAAA;AACpB,IAAA,IAAI,CAAC,OAAA,CAAQ,KAAA,EAAO,OAAO,KAAK,EAAA,EAAG;AAEnC,IAAA,MAAM,WAAA,GAAA,CAAe,MAAM,IAAA,CAAK,2BAAA,CAA4B,WAAW,CAAA,EAAG,IAAA;AAE1E,IAAA,IAAIA,mBAAA,CAAQ,0BAAA,CAA2B,OAAA,CAAQ,KAAK,CAAA,EAAG;AACtD,MAAA,OAAO,OAAA,CAAQ,KAAA,CAAM,YAAA,CAAa,QAAA,CAAS,WAAW,CAAA,GAAI,IAAA,CAAK,EAAA,EAAG,GAAI,IAAA,CAAK,eAAA,CAAgB,OAAA,EAAS,WAAW,CAAA;AAAA,IAChH;AAEA,IAAA,OAAO,OAAA,CAAQ,KAAA,CAAM,QAAA,CAAS,WAAW,CAAA,GAAI,IAAA,CAAK,EAAA,EAAG,GAAI,IAAA,CAAK,eAAA,CAAgB,OAAA,EAAS,WAAW,CAAA;AAAA,EACnG;AAAA,EAEA,MAAsB,cAAA,CACrB,WAAA,EACA,CAAA,EACA,OAAA,EACmC;AACnC,IAAA,MAAM,WAAA,GAAc,cAAA;AACpB,IAAA,IAAI,CAAC,OAAA,CAAQ,KAAA,EAAO,OAAO,KAAK,EAAA,EAAG;AAEnC,IAAA,MAAM,WAAA,GAAA,CAAe,MAAM,IAAA,CAAK,2BAAA,CAA4B,WAAW,CAAA,EAAG,IAAA;AAE1E,IAAA,IAAIA,mBAAA,CAAQ,0BAAA,CAA2B,OAAA,CAAQ,KAAK,CAAA,EAAG;AACtD,MAAA,OAAO,OAAA,CAAQ,KAAA,CAAM,cAAA,CAAe,QAAA,CAAS,WAAW,CAAA,GAAI,IAAA,CAAK,EAAA,EAAG,GAAI,IAAA,CAAK,eAAA,CAAgB,OAAA,EAAS,WAAW,CAAA;AAAA,IAClH;AAEA,IAAA,OAAO,OAAA,CAAQ,KAAA,CAAM,QAAA,CAAS,WAAW,CAAA,GAAI,IAAA,CAAK,EAAA,EAAG,GAAI,IAAA,CAAK,eAAA,CAAgB,OAAA,EAAS,WAAW,CAAA;AAAA,EACnG;AAAA,EAEQ,eAAA,CAAgB,SAAmC,WAAA,EAAkD;AAC5G,IAAA,OAAO,KAAK,KAAA,CAAM;AAAA,MACjB,YAAYC,2BAAA,CAAY,iBAAA;AAAA,MACxB,OAAA,EAAS,uBAAuB,WAAW,CAAA,iCAAA,CAAA;AAAA,MAC3C,OAAA,EAAS,EAAE,KAAA,EAAO,OAAA,CAAQ,KAAA;AAAM,KAChC,CAAA;AAAA,EACF;AACD,CAAA;AAvD2D,MAAA,CAAA,iBAAA,EAAA,kBAAA,CAAA;AAApD,IAAM,gBAAA,GAAN;AAyDP,KAAKC,gBAAA,CAAU,OAAO,SAAA,CAAU;AAAA,EAC/B,IAAA,EAAM,OAAA;AAAA,EACN,KAAA,EAAO,gBAAA;AAAA,EACP,KAAA,EAAO;AACR,CAAC,CAAA","file":"RunIn.cjs","sourcesContent":["import { container } from '@sapphire/pieces';\nimport type { ChatInputCommandInteraction, ContextMenuCommandInteraction, Message } from 'discord.js';\nimport { Identifiers } from '../lib/errors/Identifiers';\nimport { Command } from '../lib/structures/Command';\nimport { AllFlowsPrecondition, type Preconditions } from '../lib/structures/Precondition';\nimport type { ChatInputCommand, ContextMenuCommand, MessageCommand } from '../lib/types/CommandTypes';\n\nexport interface RunInPreconditionContext extends AllFlowsPrecondition.Context {\n\ttypes?: Preconditions['RunIn']['types'];\n}\n\nexport class CorePrecondition extends AllFlowsPrecondition {\n\tpublic override messageRun(message: Message<boolean>, _: MessageCommand, context: RunInPreconditionContext): AllFlowsPrecondition.Result {\n\t\tconst commandType = 'message';\n\t\tif (!context.types) return this.ok();\n\n\t\tconst channelType = message.channel.type;\n\n\t\tif (Command.runInTypeIsSpecificsObject(context.types)) {\n\t\t\treturn context.types.messageRun.includes(channelType) ? this.ok() : this.makeSharedError(context, commandType);\n\t\t}\n\n\t\treturn context.types.includes(channelType) ? this.ok() : this.makeSharedError(context, commandType);\n\t}\n\n\tpublic override async chatInputRun(\n\t\tinteraction: ChatInputCommandInteraction,\n\t\t_: ChatInputCommand,\n\t\tcontext: RunInPreconditionContext\n\t): AllFlowsPrecondition.AsyncResult {\n\t\tconst commandType = 'chat input';\n\t\tif (!context.types) return this.ok();\n\n\t\tconst channelType = (await this.fetchChannelFromInteraction(interaction)).type;\n\n\t\tif (Command.runInTypeIsSpecificsObject(context.types)) {\n\t\t\treturn context.types.chatInputRun.includes(channelType) ? this.ok() : this.makeSharedError(context, commandType);\n\t\t}\n\n\t\treturn context.types.includes(channelType) ? this.ok() : this.makeSharedError(context, commandType);\n\t}\n\n\tpublic override async contextMenuRun(\n\t\tinteraction: ContextMenuCommandInteraction,\n\t\t_: ContextMenuCommand,\n\t\tcontext: RunInPreconditionContext\n\t): AllFlowsPrecondition.AsyncResult {\n\t\tconst commandType = 'context menu';\n\t\tif (!context.types) return this.ok();\n\n\t\tconst channelType = (await this.fetchChannelFromInteraction(interaction)).type;\n\n\t\tif (Command.runInTypeIsSpecificsObject(context.types)) {\n\t\t\treturn context.types.contextMenuRun.includes(channelType) ? this.ok() : this.makeSharedError(context, commandType);\n\t\t}\n\n\t\treturn context.types.includes(channelType) ? this.ok() : this.makeSharedError(context, commandType);\n\t}\n\n\tprivate makeSharedError(context: RunInPreconditionContext, commandType: string): AllFlowsPrecondition.Result {\n\t\treturn this.error({\n\t\t\tidentifier: Identifiers.PreconditionRunIn,\n\t\t\tmessage: `You cannot run this ${commandType} command in this type of channel.`,\n\t\t\tcontext: { types: context.types }\n\t\t});\n\t}\n}\n\nvoid container.stores.loadPiece({\n\tname: 'RunIn',\n\tpiece: CorePrecondition,\n\tstore: 'preconditions'\n});\n"]}