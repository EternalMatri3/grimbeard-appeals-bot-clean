{"version":3,"sources":["../../../../src/lib/structures/ListenerLoaderStrategy.ts"],"names":[],"mappings":";;;AAIO,IAAM,uBAAA,GAAN,MAAM,uBAAA,SAA+B,cAAA,CAAyB;AAAA,EACpD,MAAA,CAAO,QAAuB,KAAA,EAAiB;AAC9D,IAAA,MAAM,gBAAA,GAAmB,MAAM,WAAW,CAAA;AAC1C,IAAA,IAAI,gBAAA,EAAkB;AACrB,MAAA,MAAM,UAAU,KAAA,CAAM,OAAA;AAGtB,MAAA,MAAM,YAAA,GAAe,QAAQ,eAAA,EAAgB;AAC7C,MAAA,IAAI,YAAA,KAAiB,CAAA,EAAG,OAAA,CAAQ,eAAA,CAAgB,eAAe,CAAC,CAAA;AAEhE,MAAA,OAAA,CAAQ,MAAM,IAAA,GAAO,MAAA,GAAS,IAAI,CAAA,CAAE,KAAA,CAAM,OAAO,gBAAgB,CAAA;AAAA,IAClE;AAAA,EACD;AAAA,EAEgB,QAAA,CAAS,QAAuB,KAAA,EAAiB;AAChE,IAAA,MAAM,gBAAA,GAAmB,MAAM,WAAW,CAAA;AAC1C,IAAA,IAAI,CAAC,KAAA,CAAM,IAAA,IAAQ,gBAAA,EAAkB;AACpC,MAAA,MAAM,UAAU,KAAA,CAAM,OAAA;AAGtB,MAAA,MAAM,YAAA,GAAe,QAAQ,eAAA,EAAgB;AAC7C,MAAA,IAAI,YAAA,KAAiB,CAAA,EAAG,OAAA,CAAQ,eAAA,CAAgB,eAAe,CAAC,CAAA;AAEhE,MAAA,OAAA,CAAQ,GAAA,CAAI,KAAA,CAAM,KAAA,EAAO,gBAAgB,CAAA;AACzC,MAAA,KAAA,CAAM,WAAW,CAAA,GAAI,IAAA;AAAA,IACtB;AAAA,EACD;AACD,CAAA;AA3BqE,MAAA,CAAA,uBAAA,EAAA,wBAAA,CAAA;AAA9D,IAAM,sBAAA,GAAN","file":"ListenerLoaderStrategy.mjs","sourcesContent":["import { LoaderStrategy } from '@sapphire/pieces';\nimport type { Listener } from './Listener';\nimport type { ListenerStore } from './ListenerStore';\n\nexport class ListenerLoaderStrategy extends LoaderStrategy<Listener> {\n\tpublic override onLoad(_store: ListenerStore, piece: Listener) {\n\t\tconst listenerCallback = piece['_listener'];\n\t\tif (listenerCallback) {\n\t\t\tconst emitter = piece.emitter!;\n\n\t\t\t// Increment the maximum amount of listeners by one:\n\t\t\tconst maxListeners = emitter.getMaxListeners();\n\t\t\tif (maxListeners !== 0) emitter.setMaxListeners(maxListeners + 1);\n\n\t\t\temitter[piece.once ? 'once' : 'on'](piece.event, listenerCallback);\n\t\t}\n\t}\n\n\tpublic override onUnload(_store: ListenerStore, piece: Listener) {\n\t\tconst listenerCallback = piece['_listener'];\n\t\tif (!piece.once && listenerCallback) {\n\t\t\tconst emitter = piece.emitter!;\n\n\t\t\t// Increment the maximum amount of listeners by one:\n\t\t\tconst maxListeners = emitter.getMaxListeners();\n\t\t\tif (maxListeners !== 0) emitter.setMaxListeners(maxListeners - 1);\n\n\t\t\temitter.off(piece.event, listenerCallback);\n\t\t\tpiece['_listener'] = null;\n\t\t}\n\t}\n}\n"]}